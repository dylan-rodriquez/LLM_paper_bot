# Composite Flow Matching for Reinforcement Learning with Shifted-Dynamics Data

**Authors:** Lingkai Kong, Haichuan Wang, Tonghan Wang, Guojun Xiong, Milind Tambe

**Published:** 2025-05-31 | **Source:** arXiv RSS

**Categories:** cs.LG

**Significance Score:** 82.0/100

## Abstract

arXiv:2505.23062v1 Announce Type: new 
Abstract: Incorporating pre-collected offline data from a source environment can significantly improve the sample efficiency of reinforcement learning (RL), but this benefit is often challenged by discrepancies between the transition dynamics of the source and target environments. Existing methods typically address this issue by penalizing or filtering out source transitions in high dynamics-gap regions. However, their estimation of the dynamics gap often relies on KL divergence or mutual information, which can be ill-defined when the source and target dynamics have disjoint support. To overcome these limitations, we propose CompFlow, a method grounded in the theoretical connection between flow matching and optimal transport. Specifically, we model the target dynamics as a conditional flow built upon the output distribution of the source-domain flow, rather than learning it directly from a Gaussian prior. This composite structure offers two key advantages: (1) improved generalization for learning target dynamics, and (2) a principled estimation of the dynamics gap via the Wasserstein distance between source and target transitions. Leveraging our principled estimation of the dynamics gap, we further introduce an optimistic active data collection strategy that prioritizes exploration in regions of high dynamics gap, and theoretically prove that it reduces the performance disparity with the optimal policy. Empirically, CompFlow outperforms strong baselines across several RL benchmarks with shifted dynamics.

## Analysis

**Innovation Score:** 75.0/100
**Impact Score:** 70.0/100  
**Sentiment Score:** 80.0/100

**Justification:** This paper addresses a crucial challenge in reinforcement learning â€“ leveraging offline data from different environments. The proposed 'CompFlow' method, grounded in flow matching and optimal transport, offers a potentially robust solution to the dynamics gap problem, particularly when traditional divergence measures fail. The approach of modeling the target dynamics as a conditional flow is a clever idea, and the theoretical connection to optimal transport adds rigor. While the abstract doesn't detail experimental results, the problem is well-motivated and the proposed solution appears promising.

## Keywords

dynamics, source, dynamics gap, gap, target, flow, learning, data, estimation, estimation dynamics

## Links

- [Paper URL](https://arxiv.org/abs/2505.23062)

---
*Auto-generated on 2025-05-31 09:25:12 UTC*
